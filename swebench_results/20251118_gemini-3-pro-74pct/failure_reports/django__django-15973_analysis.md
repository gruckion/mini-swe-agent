# Failure Analysis: django__django-15973

## Basic Info
```
{
  "exit_status": "Submitted",
  "api_calls": 51,
  "cost": 0.5795114000000001
}
```

## Token Usage
- Max prompt tokens: 31306

## Files Modified in Submission
```
- django/db/backends/base/schema.py
- django/db/backends/sqlite3/schema.py
```

## Rule Violation Check

## Agent Reasoning About Tests
```
```

## Submission Diff (first 100 lines)
```diff
diff --git a/django/db/backends/base/schema.py b/django/db/backends/base/schema.py
index 09785e8586..796dd40f73 100644
--- a/django/db/backends/base/schema.py
+++ b/django/db/backends/base/schema.py
@@ -450,14 +450,14 @@ class BaseDatabaseSchemaEditor:
 
         # Make M2M tables
         for field in model._meta.local_many_to_many:
-            if field.remote_field.through._meta.auto_created:
+            if hasattr(field.remote_field.through, '_meta') and field.remote_field.through._meta.auto_created:
                 self.create_model(field.remote_field.through)
 
     def delete_model(self, model):
         """Delete a model from the database."""
         # Handle auto-created intermediary models
         for field in model._meta.local_many_to_many:
-            if field.remote_field.through._meta.auto_created:
+            if hasattr(field.remote_field.through, '_meta') and field.remote_field.through._meta.auto_created:
                 self.delete_model(field.remote_field.through)
 
         # Delete the table
@@ -630,7 +630,7 @@ class BaseDatabaseSchemaEditor:
         involve adding a table instead (for M2M fields).
         """
         # Special-case implicit M2M tables
-        if field.many_to_many and field.remote_field.through._meta.auto_created:
+        if field.many_to_many and hasattr(field.remote_field.through, '_meta') and field.remote_field.through._meta.auto_created:
             return self.create_model(field.remote_field.through)
         # Get the column's definition
         definition, params = self.column_sql(model, field, include_default=True)
@@ -704,7 +704,7 @@ class BaseDatabaseSchemaEditor:
         but for M2Ms may involve deleting a table.
         """
         # Special-case implicit M2M tables
-        if field.many_to_many and field.remote_field.through._meta.auto_created:
+        if field.many_to_many and hasattr(field.remote_field.through, '_meta') and field.remote_field.through._meta.auto_created:
             return self.delete_model(field.remote_field.through)
         # It might not actually have a column behind it
         if field.db_parameters(connection=self.connection)["type"] is None:
@@ -759,8 +759,8 @@ class BaseDatabaseSchemaEditor:
             and (
                 old_field.remote_field.through
                 and new_field.remote_field.through
-                and old_field.remote_field.through._meta.auto_created
-                and new_field.remote_field.through._meta.auto_created
+                and hasattr(old_field.remote_field.through, '_meta') and old_field.remote_field.through._meta.auto_created
+                and hasattr(new_field.remote_field.through, '_meta') and new_field.remote_field.through._meta.auto_created
             )
         ):
             return self._alter_many_to_many(model, old_field, new_field, strict)
@@ -770,8 +770,8 @@ class BaseDatabaseSchemaEditor:
             and (
                 old_field.remote_field.through
                 and new_field.remote_field.through
-                and not old_field.remote_field.through._meta.auto_created
-                and not new_field.remote_field.through._meta.auto_created
+                and not (hasattr(old_field.remote_field.through, '_meta') and old_field.remote_field.through._meta.auto_created)
+                and not (hasattr(new_field.remote_field.through, '_meta') and new_field.remote_field.through._meta.auto_created)
             )
         ):
             # Both sides have through models; this is a no-op.
diff --git a/django/db/backends/sqlite3/schema.py b/django/db/backends/sqlite3/schema.py
index 6c106ae868..59ce07bf35 100644
--- a/django/db/backends/sqlite3/schema.py
+++ b/django/db/backends/sqlite3/schema.py
@@ -258,7 +258,7 @@ class DatabaseSchemaEditor(BaseDatabaseSchemaEditor):
             # Remove any implicit M2M tables
             if (
                 delete_field.many_to_many
-                and delete_field.remote_field.through._meta.auto_created
+                and hasattr(delete_field.remote_field.through, '_meta') and delete_field.remote_field.through._meta.auto_created
             ):
                 return self.delete_model(delete_field.remote_field.through)
         # Work inside a new app registry
@@ -403,7 +403,7 @@ class DatabaseSchemaEditor(BaseDatabaseSchemaEditor):
         # M2M fields are a special case
         if field.many_to_many:
             # For implicit M2M tables, delete the auto-created table
-            if field.remote_field.through._meta.auto_created:
+            if hasattr(field.remote_field.through, '_meta') and field.remote_field.through._meta.auto_created:
                 self.delete_model(field.remote_field.through)
             # For explicit "through" M2M fields, do nothing
         elif (
@@ -470,14 +470,14 @@ class DatabaseSchemaEditor(BaseDatabaseSchemaEditor):
                 if not remote_field.many_to_many:
                     if remote_field.field_name == new_field.name:
                         related_models.add(remote_field.related_model)
-                elif new_field.primary_key and remote_field.through._meta.auto_created:
+                elif new_field.primary_key and hasattr(remote_field.through, '_meta') and remote_field.through._meta.auto_created:
                     related_models.add(remote_field.through)
             if new_field.primary_key:
                 for many_to_many in opts.many_to_many:
                     # Ignore self-relationship since the table was already rebuilt.
                     if many_to_many.related_model == model:
                         continue
-                    if many_to_many.remote_field.through._meta.auto_created:
+                    if hasattr(many_to_many.remote_field.through, '_meta') and many_to_many.remote_field.through._meta.auto_created:
                         related_models.add(many_to_many.remote_field.through)
             for related_model in related_models:
                 self._remake_table(related_model)
```
